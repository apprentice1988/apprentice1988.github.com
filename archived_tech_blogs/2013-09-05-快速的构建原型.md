---
layout: post
category: Practicing Ruby
---
只要你有过应用快速开发 的经历，就会体会到，基本上对于任何类型的项目，Ruby都可以使原型概念的实现变得容易。这篇文章中，我们将浏览一下如果创建原型，分享一些对我来说比较适用的技巧。
今天我们将适用一段代码，类似俄罗斯方块，执行块体下落的游戏。如果你不熟悉俄罗斯方块，可以[前往freetetris.org](http://freetetris.org/)体验一下，再回来继续我们的文章。
我们假设你对于这个游戏已经很了解了，我将带你看一下从我们最初的想法到生成一段代码来实现该想法的整个过程。
####计划阶段
想了几个方案后，我才确定用块体下落的游戏作为我们这一章的例子，因为它难易适度，不会让你一蹴而就的写完，同时又足够简单使你快速上手。
对我来说下一步就是设定关于这个概念的一系列要求。为了防止这一步没完没了的执行，我必须设定一个时间上限。因为使用Ruby，集中精力短时间的努力就可以把你带到很远，我习惯把这一步设定为一两个小时。
目前我知道，我不是想要建立一个交互式的demo。 将用户输入和屏幕显示异步对于正常操作的人们在一定程度上可能会比较容易。但是我自己关于并发的知识比较有限。我尝试话费几个小时的时间在这方面，但是无果。幸运的是，即使没有时间循环，仍然存在许多的选择去创建一个有说服力的demo。
最开始我有些乐观了。我想我可以放一片物体在屏幕上，然后让重力接管它，当他落到下方后消除完成的行。但是这需要我执行碰撞检测，我现在还不打算立马处理这个问题。
最后，我想出一个主意，只有当物体碰撞到网格边界时，执行一个动作。这个过程涉及到将一个活动的物块转成非活跃状态，然后消除所有已经完成的行。这些事情，我觉得这个是我在一两个小时内有能力完成的，所以我决定试一试，再看一下是否有未知的问题出现。
我本可以立马开始写代码，但是很讽刺的是这又是我在快速创建原型的时候极力避免的行为。如果这是一个商业项目，我需要客户的2-4个小时的时间，我希望把他们的钱用在最有可能的方向上，选择了错误方向，极有可能抬高报价，而且难易产生想要的结果。
下面，我将通过将我们的想法转化为一系列的需求来开始我们的代码之路。
####提出需求阶段
一个好的原型不是一个从上而下或者从下而上的设计，而应该是一个由里到外的过程。亲手将问题切成一小段一小段的，可以强迫你去思考这个系统的很多方面，而不是一次性想所有的问题。这将允许你在实现全部项目的过程中实现你的许多知识，甚至比较好的代码块重复使用。
关键是要开始一个用户能实际感知的行为。这就意味着你应该从特征，而不是功能和对象角度去思考。一些朋友使用记述性框架，类似cucumber去帮助规范这种由里及外的想法，但是我个人更提倡一个好的，更简洁的例子，不用考虑将我们的想法硬塞入一个常规的配置中。
为此，我创建了一个简单的text文件，包含了两种情况，一个是需要消行，一种情况不需要消行。
#####1：消行

```
==========


	 #
	 #|    |
  |#||  ||
|||#||||||
```
######换成

```
==========


	 |
	 ||    | 
  ||||  ||
```

#####2：不消行

```
==========


	#
	##|    |
	|#||  ||
||| ||||||
```
######变成

```
==========

	|
	|||    |
	||||  ||
||| ||||||
```
我们基本的原型目标已经勾出了框架，我将开始写简单的程序实现我们这个转换。

#####写代码阶段
有一家事情，我必须公开承认，但话费半天时间由头到尾构造原型的时候，我倾向于放松对于测试和写简洁代码的标准。因为当我一头扎进新的问题范畴内，直到我对整个项目有了基本理解之前，强调代码质量实际上会阻碍开发的过程。
我现在尤其要做的是写一个文件实现这两个情况